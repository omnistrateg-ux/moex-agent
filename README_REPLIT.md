# MOEX Agent â€” AI-Powered Trading Signal Generator

## ğŸ¯ Ğ§Ñ‚Ğ¾ ÑÑ‚Ğ¾?

**MOEX Agent** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ñ… ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¾Ğ² Ğ´Ğ»Ñ ĞœĞ¾ÑĞºĞ¾Ğ²ÑĞºĞ¾Ğ¹ Ğ±Ğ¸Ñ€Ğ¶Ğ¸ Ñ Ğ¼Ğ°Ñ€Ğ¶Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ñ€Ğ¸ÑĞº-Ğ¼ĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Ğ¿Ñ€Ğ¾Ğ¿-Ñ‚Ñ€ĞµĞ¹Ğ´Ğ¸Ğ½Ğ³ Ğ´ĞµÑĞºĞ°.

### ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸:
- ğŸ¤– **ML-Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸** Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ñ†ĞµĞ½Ñ‹ (4 Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°: 5m, 10m, 30m, 1h)
- ğŸ“Š **Walk-Forward Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ** â€” Ñ‡ĞµÑÑ‚Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ±ĞµĞ· data leakage
- âš¡ **Real-time Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³** 46 Ğ°ĞºÑ†Ğ¸Ğ¹ MOEX
- ğŸ›¡ï¸ **Risk Engine** â€” Kill-Switch, Dynamic Leverage, Regime Detection
- ğŸ“± **Telegram ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ** Ğ¾ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°Ñ… Ğ¸ ÑĞ´ĞµĞ»ĞºĞ°Ñ…
- ğŸŒ **Web Dashboard** Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

---

## ğŸ“ˆ ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹ (Walk-Forward)

| Ğ“Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚ | Win Rate | Profit Factor | Sharpe |
|----------|----------|---------------|--------|
| 5m       | 56.8%    | 2.33          | 3.44   |
| 10m      | 56.0%    | 2.31          | 3.74   |
| 30m      | 56.0%    | 2.39          | 4.33   |
| 1h       | 55.4%    | 2.39          | 4.90   |

**Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ:** 32.6M ÑĞ²ĞµÑ‡ĞµĞ¹, 4+ Ğ³Ğ¾Ğ´Ğ° Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸

---

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MOEX Agent                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  MOEX    â”‚â”€â”€â”€â–¶â”‚ Feature  â”‚â”€â”€â”€â–¶â”‚    ML    â”‚              â”‚
â”‚  â”‚  ISS API â”‚    â”‚ Engine   â”‚    â”‚  Models  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚       â”‚               â”‚               â”‚                     â”‚
â”‚       â–¼               â–¼               â–¼                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ SQLite   â”‚    â”‚  29+     â”‚    â”‚ Predict  â”‚              â”‚
â”‚  â”‚ Storage  â”‚    â”‚ Features â”‚    â”‚ Signals  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                       â”‚                     â”‚
â”‚                                       â–¼                     â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚                              â”‚  Risk Engine â”‚               â”‚
â”‚                              â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
â”‚                              â”‚ â€¢ Kill-Switchâ”‚               â”‚
â”‚                              â”‚ â€¢ Leverage   â”‚               â”‚
â”‚                              â”‚ â€¢ Regime     â”‚               â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                       â”‚                     â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                    â–¼                  â–¼                  â–¼  â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚             â”‚ Telegram â”‚      â”‚  Paper   â”‚      â”‚  Web   â”‚ â”‚
â”‚             â”‚   Bot    â”‚      â”‚ Trading  â”‚      â”‚   UI   â”‚ â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
moex_agent/
â”œâ”€â”€ moex_agent/                 # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ¿Ğ°ĞºĞµÑ‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ __main__.py             # Entry point
â”‚   â”‚
â”‚   â”‚â”€â”€ # === DATA LAYER ===
â”‚   â”œâ”€â”€ moex_iss.py             # API ĞºĞ»Ğ¸ĞµĞ½Ñ‚ MOEX ISS
â”‚   â”œâ”€â”€ storage.py              # SQLite Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ
â”‚   â”œâ”€â”€ bootstrap.py            # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
â”‚   â”‚
â”‚   â”‚â”€â”€ # === FEATURE ENGINEERING ===
â”‚   â”œâ”€â”€ features.py             # 29 Ñ‚ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²
â”‚   â”œâ”€â”€ labels.py               # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ¾Ğº Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ
â”‚   â”‚
â”‚   â”‚â”€â”€ # === ML MODELS ===
â”‚   â”œâ”€â”€ predictor.py            # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸ inference Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
â”‚   â”œâ”€â”€ train.py                # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ
â”‚   â”œâ”€â”€ advanced_train.py       # Walk-Forward Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ
â”‚   â”‚
â”‚   â”‚â”€â”€ # === SIGNAL GENERATION ===
â”‚   â”œâ”€â”€ anomaly.py              # Ğ”ĞµÑ‚ĞµĞºÑ†Ğ¸Ñ Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¹ (ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¾Ğ²)
â”‚   â”œâ”€â”€ engine.py               # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ pipeline
â”‚   â”‚
â”‚   â”‚â”€â”€ # === RISK MANAGEMENT ===
â”‚   â”œâ”€â”€ margin_risk_engine.py   # Kill-Switch, Leverage, Regime
â”‚   â”œâ”€â”€ bcs_broker.py           # Ğ›Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ Ğ±Ñ€Ğ¾ĞºĞµÑ€Ğ° Ğ‘ĞšĞ¡
â”‚   â”œâ”€â”€ risk.py                 # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ñ€Ğ¸ÑĞº-Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸
â”‚   â”‚
â”‚   â”‚â”€â”€ # === TRADING ===
â”‚   â”œâ”€â”€ paper_trading.py        # Paper trading (Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹)
â”‚   â”œâ”€â”€ margin_paper_trading.py # Margin paper trading
â”‚   â”œâ”€â”€ live.py                 # Live Ñ€ĞµĞ¶Ğ¸Ğ¼
â”‚   â”‚
â”‚   â”‚â”€â”€ # === INTERFACE ===
â”‚   â”œâ”€â”€ telegram.py             # Telegram ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
â”‚   â”œâ”€â”€ webapp.py               # FastAPI web server
â”‚   â”œâ”€â”€ dashboard.py            # Web dashboard
â”‚   â”‚
â”‚   â”‚â”€â”€ # === CONFIG ===
â”‚   â”œâ”€â”€ config.py               # Legacy config
â”‚   â”œâ”€â”€ config_schema.py        # Pydantic config schema
â”‚   â””â”€â”€ logging_config.py       # Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚
â”œâ”€â”€ models/                     # ĞĞ±ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
â”‚   â”œâ”€â”€ model_time_5m.joblib
â”‚   â”œâ”€â”€ model_time_10m.joblib
â”‚   â”œâ”€â”€ model_time_30m.joblib
â”‚   â””â”€â”€ model_time_1h.joblib
â”‚
â”œâ”€â”€ data/                       # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸)
â”‚   â”œâ”€â”€ moex_agent.sqlite       # Ğ‘Ğ°Ğ·Ğ° ÑĞ²ĞµÑ‡ĞµĞ¹
â”‚   â””â”€â”€ margin_paper_state.json # Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ paper trading
â”‚
â”œâ”€â”€ config.yaml                 # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
â”œâ”€â”€ requirements.txt            # Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
â””â”€â”€ pyproject.toml              # Python package config
```

---

## ğŸ”„ ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°

### 1. Ğ¡Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
```
MOEX ISS API â†’ 1-Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ½Ñ‹Ğµ ÑĞ²ĞµÑ‡Ğ¸ â†’ SQLite
```
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ OHLCV Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ 46 Ñ‚Ğ¸ĞºĞµÑ€Ğ¾Ğ²
- Ğ¥Ñ€Ğ°Ğ½Ğ¸Ğ¼ Ğ² SQLite Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°

### 2. Feature Engineering (29 Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²)
```python
# Trend
- SMA 20, 50
- EMA 12, 26
- MACD, Signal, Histogram

# Momentum
- RSI 14
- Stochastic %K, %D
- ROC 10, 20
- Williams %R

# Volatility
- ATR 14
- Bollinger Bands (width, %B)
- Keltner Channels

# Volume
- OBV, OBV change
- VWAP
- Volume SMA ratio

# Price Action
- Candle body ratio
- Upper/Lower shadows
- Gap detection
```

### 3. ML Prediction
```
Features â†’ HistGradientBoosting â†’ Probability[0-1]
```
- 4 Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ¾Ğ²
- ĞšĞ°Ğ»Ğ¸Ğ±Ñ€Ğ¾Ğ²ĞºĞ° Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ĞµĞ¹ (Isotonic)
- Threshold: 54% Ğ´Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´Ğ°

### 4. Risk Assessment
```python
def assess_trade(signal):
    # 1. Regime Detection (BULL/BEAR/SIDEWAYS/HIGH_VOL)
    regime = detect_regime(candles)

    # 2. Kill-Switch Check
    if daily_loss >= 2% or weekly_loss >= 5%:
        return DISABLE

    # 3. Dynamic Leverage
    leverage = f(confidence, regime, volatility, drawdown)

    # 4. Position Sizing
    size = max_risk / (atr * leverage)

    return ALLOW if leverage > 0 else DISABLE
```

### 5. Execution (Paper Trading)
```
Signal + Risk OK â†’ Open Position â†’ Monitor â†’ Close (Take/Stop/Timeout)
```

---

## ğŸ›¡ï¸ Risk Management Rules

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ |
|----------|-------|
| Max loss per trade | 0.5% equity |
| Max daily loss | 2% |
| Max weekly loss | 5% |
| Max drawdown | 10% |
| Kill after losses | 5 Ğ¿Ğ¾Ğ´Ñ€ÑĞ´ |
| Disabled horizons | 1d, 1w (gap risk) |

### Dynamic Leverage Formula
```
base_lev = HORIZON_MAX[horizon]  # 5m=3x, 10m=3x, 30m=2.5x, 1h=2x

multipliers:
  confidence: (prob - 0.54) / 0.1  # 0.54-0.64 â†’ 0-1
  regime: BULL=1.0, SIDEWAYS=0.7, HIGH_VOL=0.3, BEAR=0.0
  volatility: 1.0 - vol_percentile * 0.5
  drawdown: 1.0 - (dd_pct / 10) * 0.5
  loss_streak: 1.0 - streak * 0.15

final_leverage = base_lev * product(multipliers)
```

---

## ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº

### Paper Trading (Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼)
```bash
python -m moex_agent.margin_paper_trading
```

### Web Dashboard
```bash
python -m moex_agent.webapp
# â†’ http://localhost:8080
```

### Bootstrap Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
```bash
python -m moex_agent.bootstrap --days 14
```

### ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
```bash
python -m moex_agent.advanced_train --horizons 5m 10m 30m 1h
```

---

## ğŸŒ Web API Endpoints

| Endpoint | Method | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|----------|--------|----------|
| `/` | GET | Dashboard HTML |
| `/api/status` | GET | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ |
| `/api/signals` | GET | Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹ |
| `/api/positions` | GET | ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ |
| `/api/trades` | GET | Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ ÑĞ´ĞµĞ»Ğ¾Ğº |
| `/api/equity` | GET | Equity curve |
| `/health` | GET | Health check |

---

## âš™ï¸ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (config.yaml)

```yaml
app:
  poll_seconds: 5          # Ğ˜Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ¾Ğ¿Ñ€Ğ¾ÑĞ°
  cooldown_minutes: 30     # ĞšÑƒĞ»Ğ´Ğ°ÑƒĞ½ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°Ğ¼Ğ¸

storage:
  sqlite_path: "data/moex_agent.sqlite"

universe:
  tickers:
    - SBER
    - GAZP
    - LKOH
    # ... 46 Ñ‚Ğ¸ĞºĞµÑ€Ğ¾Ğ²

signals:
  horizons:
    - { name: "5m",  minutes: 5 }
    - { name: "10m", minutes: 10 }
    - { name: "30m", minutes: 30 }
    - { name: "1h",  minutes: 60 }
  p_threshold: 0.52
  price_exit:
    take_atr: 0.70
    stop_atr: 0.40

telegram:
  enabled: true
  # Set via environment: TELEGRAM_BOT_TOKEN, TELEGRAM_CHAT_ID
```

---

## ğŸ”‘ Environment Variables

| Variable | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|----------|----------|
| `TELEGRAM_BOT_TOKEN` | Ğ¢Ğ¾ĞºĞµĞ½ Telegram Ğ±Ğ¾Ñ‚Ğ° |
| `TELEGRAM_CHAT_ID` | ID Ñ‡Ğ°Ñ‚Ğ° Ğ´Ğ»Ñ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹ |

---

## ğŸ“Š ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°

### Telegram ÑĞ¸Ğ³Ğ½Ğ°Ğ»:
```
ğŸ° MARGIN PAPER TRADING

ğŸ“ˆ ĞĞĞ’ĞĞ¯ ĞŸĞĞ—Ğ˜Ğ¦Ğ˜Ğ¯
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ SBER | LONG
ğŸ“Š ĞŸĞ»ĞµÑ‡Ğ¾: 2.1x | Ğ ĞµĞ¶Ğ¸Ğ¼: BULL
ğŸ’µ Ğ¦ĞµĞ½Ğ°: 267.50 â‚½
ğŸ“¦ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: 150 ÑˆÑ‚. (85,000 â‚½)
ğŸ¯ Take: 269.80 | Stop: 266.10
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’µ EQUITY: 200,000 â‚½
```

### Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ ÑĞ´ĞµĞ»ĞºĞ¸:
```
ğŸ° MARGIN PAPER TRADING

âœ… Ğ¡Ğ”Ğ•Ğ›ĞšĞ Ğ—ĞĞšĞ Ğ«Ğ¢Ğ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ SBER (LONG)
ğŸ“Š ĞŸĞ»ĞµÑ‡Ğ¾: 2.1x
ğŸ’° ĞŸĞ Ğ˜Ğ‘Ğ«Ğ›Ğ¬: +1,450 â‚½ (+1.71%)
ğŸ“Š ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°: take
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’µ EQUITY: 201,450 â‚½
ğŸ“‰ Drawdown: 0.0%
ğŸ”¢ Loss Streak: 0
```

---

## ğŸ“ Ğ”Ğ»Ñ Replit AI

**ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚:** Ğ­Ñ‚Ğ¾ production-ready Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ğ»Ñ MOEX. ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ñ‹ Ğ½Ğ° 32M ÑĞ²ĞµÑ‡ĞµĞ¹ Ñ Walk-Forward Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸ĞµĞ¹.

**Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹:**
- `margin_paper_trading.py` â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ trading loop
- `margin_risk_engine.py` â€” Ñ€Ğ¸ÑĞº-Ğ¼ĞµĞ½ĞµĞ´Ğ¶Ğ¼ĞµĞ½Ñ‚
- `webapp.py` â€” web Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
- `features.py` â€” feature engineering
- `predictor.py` â€” ML inference

**Ğ”Ğ»Ñ Ğ²ĞµĞ±-Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°:**
1. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ `webapp.py` Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 8080
2. Dashboard Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚: equity, Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸, ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹, Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ
3. API Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ JSON Ğ´Ğ»Ñ Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´Ğ°

**ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ Replit:**
- ĞĞµÑ‚ GPU (Ğ½Ğ¾ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ CPU-only)
- Storage ~1GB (Ğ±Ğ°Ğ·Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ Ğ½Ğ° Ğ»ĞµÑ‚Ñƒ)
- Ğ”Ğ»Ñ 24/7 Ğ½ÑƒĞ¶ĞµĞ½ Always On (Ğ¿Ğ»Ğ°Ñ‚Ğ½Ñ‹Ğ¹)
